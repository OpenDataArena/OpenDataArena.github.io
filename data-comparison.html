<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Dataset Details - Data Leaderboard</title>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
        <link rel="stylesheet" href="./css/style.css" />
        <link rel="stylesheet" href="./css/dropdown-styles.css" />
        <link rel="stylesheet" href="./css/mobile.css" />
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
        />
        <style>
            .tools-header {
                text-align: center;
                margin-bottom: 3rem;
                padding: 2rem;
            }
            .tools-title {
                font-size: 2.5rem;
                font-weight: 700;
                color: var(--primary-dark);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1rem;
            }
            
            .tools-subtitle {
                font-size: 1.2rem;
                color: var(--text-secondary);
                max-width: 800px;
                margin: 0 auto;
                line-height: 1.6;
            }
            @media (max-width: 768px) {
                .tools-title {
                    font-size: 2rem;
                    flex-direction: column;
                }
            }
        </style>
    </head>
    <body>
        <div id="app">
            <!-- Loading State -->
            <div v-if="loading" class="loading-spinner">
                <i class="fas fa-circle-notch fa-spin fa-3x"></i>
                <p>Loading dataset information...</p>
            </div>

            <!-- Error State -->
            <div v-if="error" class="error-message">
                <i class="fas fa-exclamation-triangle fa-3x"></i>
                <h3>{{ error }}</h3>
                <p>
                    <a href="index.html" class="back-to-leaderboard">
                        <i class="fas fa-arrow-left"></i> Back to Leaderboard
                    </a>
                </p>
            </div>

            <header class="header">
                <div class="title-container nav-left">
                    <div class="nav-title-group">
                        <h1 class="nav-main-title"><a href="index.html" class="nav-home-link">OpenDataArena</a></h1>
                        <div class="nav-slogan">Benchmark Data Value - Right at Your Fingertips</div>
                    </div>
                </div>
                <nav class="nav-right">
                    <ul class="nav-list">
                        <li class="nav-item"><a href="leaderboard.html" :class="{active: currentPage === 'leaderboard'}">Leaderboard</a></li>
                        <li class="nav-item"><a href="data-comparison.html?id=2" :class="{active: currentPage === 'comparison'}">Data Comparison</a></li>
                        <li class="nav-item"><a href="configurations.html" :class="{active: currentPage === 'rules'}">Configurations</a></li>
                        <li class="nav-item"><a href="contribution.html" :class="{active: currentPage === 'contribution'}">Contribution</a></li>
                        <li class="nav-item"><a href="tools.html" :class="{active: currentPage === 'tools'}">Tools</a></li>
                    </ul>
                </nav>
            </header> 

            <!-- 悬浮操作菜单 -->
            <div class="fab-menu">
                <div class="fab-actions">
                    <div class="fab-action fab-back">
                        <a
                            href="leaderboard.html"
                            class="fab-icon"
                            title="Back to Leaderboard"
                            ><i class="fas fa-arrow-left"></i
                        ></a>
                        <a
                            href="leaderboard.html"
                            class="fab-label-btn"
                            title="Back to Leaderboard"
                            ><i class="fas fa-arrow-left"></i
                            ><span>Back to Leaderboard</span></a
                        >
                    </div>
                    <div class="fab-action fab-feedback">
                        <button
                            class="fab-icon"
                            title="Feedback"
                            onclick="openFeedbackForm()"
                        >
                            <i class="fas fa-comment"></i>
                        </button>
                        <button
                            class="fab-label-btn"
                            title="Feedback"
                            onclick="openFeedbackForm()"
                        >
                            <i class="fas fa-comment"></i><span>Feedback</span>
                        </button>
                    </div>
                </div>
                <button class="fab-main" title="More actions">
                    <i class="fas fa-ellipsis-h"></i>
                </button>
            </div>

            <!-- Dataset Detail Content -->
            <div
                v-if="!loading && !error && llamaDataset"
                class="dataset-detail-container"
            >
                <div class="tools-header" style="width:100%; margin:0 auto; margin-bottom: 20px;">
                    <h1 class="tools-title">
                        <i class="fas fa-balance-scale"></i>
                        OpenDataArena-Dataset Comparison
                    </h1>
                    <p class="guide-subtitle" style="margin-bottom: 10px;">
                        Compare datasets by model performance and multi-dimensional data scores — for both instruction and instruction–response data.
                    </p>
                    <p class="guide-subtitle">
                        Please select datasets to compare.
                    </p>
                </div>
                <!-- Compare Controls (no section wrapper) -->
                <div class="compare-controls" style="margin-bottom: 30px">
                    <div class="compare-selection">
                        <!-- 搜索框 -->
                        <div
                            class="compare-search-bar"
                            style="margin-bottom: 10px"
                        >
                            <input
                                type="text"
                                v-model="searchInput"
                                placeholder="Search datasets..."
                                style="
                                    width: 80%;
                                    padding: 6px 10px;
                                    border-radius: 6px;
                                    border: 1px solid #ccc;
                                    font-size: 1rem;
                                    display: inline-block;
                                "
                                @keyup.enter="applySearch"
                            />
                            <button
                                @click="applySearch"
                                style="
                                    width: 8%;
                                    margin-left: 2%;
                                    padding: 6px 0;
                                    border-radius: 6px;
                                    border: 1px solid #1e40af;
                                    background: #1e40af;
                                    color: #fff;
                                    font-size: 1rem;
                                    cursor: pointer;
                                "
                            >
                                Search
                            </button>
                            <button
                                @click="clearSearch"
                                style="
                                    width: 8%;
                                    margin-left: 2%;
                                    padding: 6px 0;
                                    border-radius: 6px;
                                    border: 1px solid #ccc;
                                    background: #fff;
                                    color: #1e40af;
                                    font-size: 1rem;
                                    cursor: pointer;
                                "
                            >
                                Clear All
                            </button>
                        </div>
                        <div class="compare-dropdown">
                            <label>Select datasets to compare:</label>
                            <div class="compare-dataset-list">
                                <div
                                    v-for="ds in filteredDatasets"
                                    :key="ds.id"
                                    class="compare-dataset-item"
                                    :class="{ selected: isDatasetSelected(ds.name) }"
                                    @click="triggerCheckboxClick(ds.id)"
                                >
                                    <input
                                        type="checkbox"
                                        v-model="selectedDatasets"
                                        :value="ds.name"
                                        @click.stop
                                        :id="'compare-checkbox-' + ds.id"
                                    />
                                    <span class="dataset-name"
                                        >{{ getDisplayName(ds.name) }}</span
                                    >
                                    <span class="dataset-tags">
                                        <span
                                            v-for="tag in getDatasetTags(ds)"
                                            :key="tag"
                                            class="tag-badge small"
                                            :data-type="tag.toLowerCase()"
                                        >
                                            <i :class="getTagIcon(tag)"></i>
                                            {{ getTagDisplayName(tag) }}
                                        </span>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="compare-actions">
                            <button
                                @click="updateCharts"
                                class="compare-update-btn"
                                :disabled="selectedDatasets.length === 0"
                            >
                                <i class="fas fa-sync"></i>
                                Update Comparison ({{ selectedDatasets.length }}
                                selected)
                            </button>
                            <button
                                @click="clearComparison"
                                class="compare-clear-btn"
                                v-if="selectedDatasets.length > 0"
                            >
                                <i class="fas fa-times"></i>
                                Clear All
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Comparison Dataset Cards (Collapsible) -->
                <div
                    v-if="selectedDatasets.length > 0"
                    class="comparison-cards"
                >
                    <div
                        v-for="(dsName, idx) in selectedDatasets"
                        :key="dsName"
                        class="dataset-header comparison-card"
                        :style="getCardStyle(idx)"
                    >
                        <div
                            class="comparison-card-header"
                            @click="toggleCardCollapse(idx)"
                            :style="getCardHeaderStyle(idx)"
                        >
                            <div
                                style="
                                    display: flex;
                                    align-items: center;
                                    width: 100%;
                                "
                            >
                                <span
                                    class="comparison-card-title"
                                    style="
                                        flex: 1;
                                        display: flex;
                                        align-items: center;
                                    "
                                >
                                    {{ getDisplayName(dsName) }}
                                    <span
                                        class="external-links"
                                        style="margin-left: 14px"
                                    >
                                        <a
                                            v-if="getDatasetByName(dsName).link"
                                            :href="getDatasetByName(dsName).link"
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="external-link"
                                        >
                                            <i class="fas fa-database"></i>
                                            Hugging Face
                                        </a>
                                        <a
                                            v-if="getDatasetByName(dsName).paper_link"
                                            :href="getDatasetByName(dsName).paper_link"
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="external-link"
                                        >
                                            <i class="fas fa-file-alt"></i>
                                            Paper
                                        </a>
                                    </span>
                                </span>
                                <span
                                    style="
                                        margin-left: auto;
                                        display: flex;
                                        align-items: center;
                                    "
                                >
                                    <i
                                        :class="cardCollapsed[idx] ? 'fas fa-chevron-down' : 'fas fa-chevron-up'"
                                        style="font-size: 1.2rem"
                                    ></i>
                                </span>
                            </div>
                        </div>
                        <div
                            v-show="!cardCollapsed[idx]"
                            class="comparison-card-body"
                            :style="getCardStyle(idx)"
                        >
                            <div
                                v-if="getDatasetByName(dsName).affiliation"
                                class="dataset-affiliation"
                            >
                                <i class="fas fa-building"></i> {{
                                getDatasetByName(dsName).affiliation }}
                            </div>
                            <div class="dataset-basic-info">
                                <div class="info-item">
                                    <div class="info-label">Release Year</div>
                                    <div class="info-value">
                                        {{ getDatasetByName(dsName).year ||
                                        'N/A' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Dataset Size</div>
                                    <div class="info-value">
                                        {{ getDatasetByName(dsName).size ||
                                        'N/A' }}
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Tags</div>
                                    <div class="info-value">
                                        <span
                                            v-for="tag in getDatasetTags(getDatasetByName(dsName))"
                                            :key="tag"
                                            class="tag-badge"
                                        >
                                            <i :class="getTagIcon(tag)"></i>
                                            {{ getTagDisplayName(tag) }}
                                        </span>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">
                                        Overall Average
                                    </div>
                                    <div class="info-value">
                                        {{
                                        formatScore(getDatasetByName(dsName).overall_avg)
                                        }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Scores -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-chart-bar"></i> Performance
                            Overview
                        </h2>
                    </div>
                    <div class="section-content">
                        <!-- Domain Selection -->
                        <div class="domain-selection">
                            <div class="domain-tabs">
                                <div
                                    class="domain-tab"
                                    :class="{ active: selectedDomains.includes('overall') }"
                                    @click="toggleDomain('overall')"
                                >
                                    <input
                                        type="checkbox"
                                        :checked="selectedDomains.includes('overall')"
                                        @change="toggleDomain('overall')"
                                    />
                                    <span>Overall</span>
                                </div>
                                <div
                                    v-if="llamaDataset.task_details && llamaDataset.task_details.general_tasks"
                                    class="domain-tab"
                                    data-type="general"
                                    :class="{ active: selectedDomains.includes('general') }"
                                    @click="toggleDomain('general')"
                                >
                                    <input
                                        type="checkbox"
                                        :checked="selectedDomains.includes('general')"
                                        @change="toggleDomain('general')"
                                    />
                                    <span>General</span>
                                </div>
                                <div
                                    v-if="llamaDataset.task_details && llamaDataset.task_details.math_tasks"
                                    class="domain-tab"
                                    data-type="math"
                                    :class="{ active: selectedDomains.includes('math') }"
                                    @click="toggleDomain('math')"
                                >
                                    <input
                                        type="checkbox"
                                        :checked="selectedDomains.includes('math')"
                                        @change="toggleDomain('math')"
                                    />
                                    <span>Math</span>
                                </div>
                                <div
                                    v-if="llamaDataset.task_details && llamaDataset.task_details.code_tasks"
                                    class="domain-tab"
                                    data-type="code"
                                    :class="{ active: selectedDomains.includes('code') }"
                                    @click="toggleDomain('code')"
                                >
                                    <input
                                        type="checkbox"
                                        :checked="selectedDomains.includes('code')"
                                        @change="toggleDomain('code')"
                                    />
                                    <span>Code</span>
                                </div>
                                <div
                                    v-if="llamaDataset.task_details && llamaDataset.task_details.reasoning_tasks"
                                    class="domain-tab"
                                    data-type="reasoning"
                                    :class="{ active: selectedDomains.includes('reasoning') }"
                                    @click="toggleDomain('reasoning')"
                                >
                                    <input
                                        type="checkbox"
                                        :checked="selectedDomains.includes('reasoning')"
                                        @change="toggleDomain('reasoning')"
                                    />
                                    <span>Reasoning</span>
                                </div>
                            </div>
                        </div>

                        <!-- Dual Model Charts -->
                        <div class="dual-charts-container">
                            <!-- Llama Chart -->
                            <div class="chart-container">
                                <h3 class="dynamic-chart-title">Llama Model</h3>
                                <div class="chart-wrapper">
                                    <canvas id="llamaRadarChart"></canvas>
                                </div>
                            </div>

                            <!-- Qwen Chart -->
                            <div class="chart-container">
                                <h3 class="dynamic-chart-title">Qwen Model</h3>
                                <div class="chart-wrapper">
                                    <canvas id="qwenRadarChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 新增：Evaluation Score Overview -->
                <div
                    v-if="!loading && !error && llamaDataset"
                    class="content-section"
                >
                    <div class="section-header">
                        <h2 class="section-title">
                            <i class="fas fa-chart-bar"></i> Evaluation Score
                            Overview
                        </h2>
                    </div>
                    <div class="section-content">
                        <!-- Heuristic (Answer Length) 表格 -->
                        <div
                            class="heuristic-table-container"
                            style="
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                            "
                        >
                            <h3
                                class="dynamic-chart-title"
                                style="text-align: center; margin-bottom: 30px"
                            >
                                Heuristic (Answer Length)
                            </h3>
                            <table
                                class="heuristic-table"
                                style="
                                    min-width: 480px;
                                    width: 80%;
                                    border-collapse: separate;
                                    border-spacing: 0;
                                    background: #fff;
                                    border-radius: 12px;
                                    overflow: hidden;
                                    box-shadow: 0 2px 8px 0
                                        rgba(30, 64, 175, 0.06);
                                    margin: 0 auto;
                                    margin-bottom: 50px;
                                "
                            >
                                <thead>
                                    <tr style="background: #f3f4f6">
                                        <th
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                                min-width: 120px;
                                            "
                                        >
                                            Dataset
                                        </th>
                                        <th
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                                width: 200px;
                                            "
                                        >
                                            Min
                                        </th>
                                        <th
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                                width: 200px;
                                            "
                                        >
                                            Max
                                        </th>
                                        <th
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                                width: 200px;
                                            "
                                        >
                                            Average
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr
                                        v-for="(ds, idx) in selectedHeuristicDatasets"
                                        :key="ds.name"
                                        style="transition: background 0.2s"
                                        @mouseover="event.currentTarget.style.background='#f1f5fa'"
                                        @mouseleave="event.currentTarget.style.background=''"
                                    >
                                        <td
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                            "
                                        >
                                            <span
                                                :style="{display:'inline-block',width:'14px',height:'14px',borderRadius:'50%',background:getCardStyle(idx).background,marginRight:'8px',border:'2px solid #fff',verticalAlign:'middle'}"
                                            ></span>
                                            <span style="vertical-align: middle"
                                                >{{ getDisplayName(ds.name)
                                                }}</span
                                            >
                                        </td>
                                        <td
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                            "
                                        >
                                            {{ ds.min }}
                                        </td>
                                        <td
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                            "
                                        >
                                            {{ ds.max }}
                                        </td>
                                        <td
                                            style="
                                                text-align: center;
                                                padding: 10px 0;
                                            "
                                        >
                                            {{ ds.avg }}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div
                            class="triple-charts-container"
                            style="
                                display: flex;
                                gap: 32px;
                                margin-bottom: -50px;
                            "
                        >
                            <!-- LLM-as-Judge (Q Score) 雷达图 -->
                            <div class="chart-container" style="flex: 1">
                                <h3 class="dynamic-chart-title">
                                    LLM-as-Judge (Q Score)
                                </h3>
                                <div class="chart-wrapper">
                                    <canvas id="llmJudgeQRadarChart"></canvas>
                                </div>
                            </div>
                            <!-- LLM-as-Judge (QA Score) 雷达图 -->
                            <div class="chart-container" style="flex: 1">
                                <h3 class="dynamic-chart-title">
                                    LLM-as-Judge (QA Score)
                                </h3>
                                <div class="chart-wrapper">
                                    <canvas id="llmJudgeQARadarChart"></canvas>
                                </div>
                            </div>
                            <!-- Model-based Evaluation 雷达图 -->
                            <div class="chart-container" style="flex: 1">
                                <h3 class="dynamic-chart-title">
                                    Model-based Evaluation
                                </h3>
                                <div class="chart-wrapper">
                                    <canvas id="modelEvalRadarChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- LLM-as-Judge 主卡片 -->
                        <div class="llm-judge-main-card" style="margin-top: 32px">
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('llmjudge')"
                                    style="
                                        padding: 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #ff6b6b 0%,
                                            #ee5a24 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #e55a5a 0%, #d54a1a 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 20px;
                                            font-weight: 700;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-gavel"
                                            style="
                                                margin-right: 12px;
                                                font-size: 18px;
                                            "
                                        ></i>
                                        LLM-as-Judge
                                    </h3>
                                    <i
                                        :class="expandedCards.llmjudge ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 16px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.llmjudge"
                                    class="card-content"
                                    style="
                                        padding: 24px;
                                        transition: all 0.3s ease;
                                        background: #f8f9fa;
                                    "
                                >
                                    <!-- 内层卡片容器 -->
                                    <div class="inner-cards-container" style="display: flex; flex-direction: column; gap: 16px;">
                                        <!-- Clarity 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('clarity')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #667eea 0%,
                                            #764ba2 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #667eea 0%, #764ba2 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-chart-line"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Clarity
                                    </h3>
                                    <i
                                        :class="expandedCards.clarity ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.clarity"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="clarity-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Clarity (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Clarity (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="clarityQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Clarity (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Clarity (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="clarityQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Coherence 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('coherence')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #f093fb 0%,
                                            #f5576c 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #e085e8 0%, #e54b5f 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-link"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Coherence
                                    </h3>
                                    <i
                                        :class="expandedCards.coherence ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.coherence"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="coherence-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Coherence (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Coherence (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="coherenceQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Coherence (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Coherence (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="coherenceQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Completeness 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('completeness')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #4facfe 0%,
                                            #00f2fe 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #45a1f0 0%, #00e6f0 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-check-circle"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Completeness
                                    </h3>
                                    <i
                                        :class="expandedCards.completeness ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.completeness"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="completeness-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Completeness (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Completeness (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="completenessQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Completeness (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Completeness (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="completenessQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Complexity 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('complexity')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #fa709a 0%,
                                            #fee140 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #f0658a 0%, #fad530 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #fa709a 0%, #fee140 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-cogs"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Complexity
                                    </h3>
                                    <i
                                        :class="expandedCards.complexity ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.complexity"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="complexity-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Complexity (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Complexity (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="complexityQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Complexity (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Complexity (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="complexityQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Correctness 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('correctness')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #a8edea 0%,
                                            #fed6e3 100%
                                        );
                                        color: #333;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #9de5e2 0%, #fec5d2 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-shield-alt"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Correctness
                                    </h3>
                                    <i
                                        :class="expandedCards.correctness ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.correctness"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="correctness-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Correctness (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Correctness (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="correctnessQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Correctness (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Correctness (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="correctnessQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Meaningfulness 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('meaningfulness')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #ffecd2 0%,
                                            #fcb69f 100%
                                        );
                                        color: #333;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #ffe0c0 0%, #fbaa8a 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-lightbulb"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Meaningfulness
                                    </h3>
                                    <i
                                        :class="expandedCards.meaningfulness ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.meaningfulness"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="meaningfulness-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Meaningfulness (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Meaningfulness (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="meaningfulnessQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Meaningfulness (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Meaningfulness (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="meaningfulnessQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- OpenThoughts 卡片 -->
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                    margin-bottom: 16px;
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('openthoughts')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #43cea2 0%,
                                            #185a9d 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #36b88a 0%, #144a7d 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #43cea2 0%, #185a9d 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-brain"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        OpenThoughts and Relevance
                                    </h3>
                                    <i
                                        :class="expandedCards.openthoughts ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.openthoughts"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="openthoughts-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- OpenThoughts (Q) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                OpenThoughts (Q)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="openthoughtsQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Relevance (QA) -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Relevance (QA)
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="relevanceQALineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Model-based Evaluation 主卡片 -->
                        <div class="model-evaluation-main-card" style="margin-top: 32px">
                            <div
                                class="chart-card"
                                style="
                                    background: #fff;
                                    border-radius: 12px;
                                    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
                                    overflow: hidden;
                                    border: 1px solid #e5e7eb;
                                "
                            >
                                <div
                                    class="card-header"
                                    @click="toggleCard('modelevaluation')"
                                    style="
                                        padding: 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #4facfe 0%,
                                            #00f2fe 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #45a1f0 0%, #00e6f0 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 20px;
                                            font-weight: 700;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-gavel"
                                            style="
                                                margin-right: 12px;
                                                font-size: 18px;
                                            "
                                        ></i>
                                        Model-based Evaluation
                                    </h3>
                                    <i
                                        :class="expandedCards.modelevaluation ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 16px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.modelevaluation"
                                    class="card-content"
                                    style="
                                        padding: 24px;
                                        transition: all 0.3s ease;
                                        background: #f8f9fa;
                                    "
                                >
                                    <!-- 内层卡片容器 -->
                                    <div class="inner-cards-container" style="display: flex; flex-direction: column; gap: 16px;">
                                        <!-- Model-based Evaluation (Q) 卡片 -->
                                        <div
                                            class="chart-card"
                                            style="
                                                background: #fff;
                                                border-radius: 12px;
                                                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                                                overflow: hidden;
                                                border: 1px solid #e5e7eb;
                                            "
                                        >
                                <div
                                    class="card-header"
                                    @click="toggleCard('modelbasedq')"
                                    style="
                                        padding: 16px 20px;
                                        background: linear-gradient(
                                            135deg,
                                            #11998e 0%,
                                            #38ef7d 100%
                                        );
                                        color: white;
                                        cursor: pointer;
                                        display: flex;
                                        align-items: center;
                                        justify-content: space-between;
                                        transition: all 0.3s ease;
                                    "
                                    @mouseover="event.currentTarget.style.background='linear-gradient(135deg, #0e7c6b 0%, #2bcf6e 100%)'"
                                    @mouseleave="event.currentTarget.style.background='linear-gradient(135deg, #11998e 0%, #38ef7d 100%)'"
                                >
                                    <h3
                                        style="
                                            margin: 0;
                                            font-size: 18px;
                                            font-weight: 600;
                                            display: flex;
                                            align-items: center;
                                        "
                                    >
                                        <i
                                            class="fas fa-question-circle"
                                            style="
                                                margin-right: 12px;
                                                font-size: 16px;
                                            "
                                        ></i>
                                        Model-based Evaluation (Q)
                                    </h3>
                                    <i
                                        :class="expandedCards.modelbasedq ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                        style="
                                            transition: transform 0.3s ease;
                                            font-size: 14px;
                                        "
                                    ></i>
                                </div>
                                <div
                                    v-show="expandedCards.modelbasedq"
                                    class="card-content"
                                    style="
                                        padding: 20px;
                                        transition: all 0.3s ease;
                                    "
                                >
                                    <div
                                        class="modelbasedq-charts-container"
                                        style="
                                            display: flex;
                                            gap: 32px;
                                            justify-content: center;
                                            width: 100%;
                                        "
                                    >
                                        <!-- Deita Complexity -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Deita Complexity
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="deitaComplexityQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                        <!-- Thinking Prob -->
                                        <div
                                            class="chart-container"
                                            style="
                                                flex: 1;
                                                min-width: 320px;
                                                max-width: 480px;
                                            "
                                        >
                                            <h3
                                                class="dynamic-chart-title"
                                                style="text-align: center"
                                            >
                                                Thinking Prob
                                            </h3>
                                            <div
                                                class="chart-wrapper"
                                                style="padding-bottom: 60px"
                                            >
                                                <canvas
                                                    id="thinkingProbQLineChart"
                                                ></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Model-based Evaluation (QA) 卡片 -->
                        <div
                            class="chart-card"
                            style="
                                margin-top: 16px;
                                background: linear-gradient(
                                    135deg,
                                    #667eea 0%,
                                    #764ba2 100%
                                );
                                border-radius: 12px;
                                box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
                                overflow: hidden;
                            "
                        >
                            <div
                                class="card-header"
                                @click="toggleCard('modelbasedqa')"
                                style="
                                    padding: 20px;
                                    cursor: pointer;
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    color: white;
                                    font-weight: 600;
                                    font-size: 18px;
                                    transition: all 0.3s ease;
                                "
                            >
                                <span>
                                    <i
                                        class="fas fa-comments"
                                        style="
                                            margin-right: 12px;
                                            font-size: 16px;
                                        "
                                    ></i>
                                    Model-based Evaluation (QA)
                                </span>
                                <i
                                    :class="expandedCards.modelbasedqa ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"
                                    style="
                                        transition: transform 0.3s ease;
                                        font-size: 14px;
                                    "
                                ></i>
                            </div>
                            <div
                                v-show="expandedCards.modelbasedqa"
                                class="card-content"
                                style="
                                    padding: 20px;
                                    transition: all 0.3s ease;
                                    background: rgba(255, 255, 255, 0.95);
                                "
                            >
                                <div
                                    class="modelbasedqa-charts-container"
                                    style="
                                        display: flex;
                                        gap: 16px;
                                        justify-content: center;
                                        width: 100%;
                                    "
                                >
                                    <!-- Deita Quality -->
                                    <div
                                        class="chart-container"
                                        style="
                                            flex: 1;
                                            min-width: 280px;
                                            max-width: 400px;
                                        "
                                    >
                                        <h3
                                            class="dynamic-chart-title"
                                            style="text-align: center"
                                        >
                                            Deita Quality
                                        </h3>
                                        <div
                                            class="chart-wrapper"
                                            style="padding-bottom: 60px"
                                        >
                                            <canvas
                                                id="deitaQualityQALineChart"
                                            ></canvas>
                                        </div>
                                    </div>
                                    <!-- IFD -->
                                    <div
                                        class="chart-container"
                                        style="
                                            flex: 1;
                                            min-width: 280px;
                                            max-width: 400px;
                                        "
                                    >
                                        <h3
                                            class="dynamic-chart-title"
                                            style="text-align: center"
                                        >
                                            IFD
                                        </h3>
                                        <div
                                            class="chart-wrapper"
                                            style="padding-bottom: 60px"
                                        >
                                            <canvas id="ifdQABarChart"></canvas>
                                        </div>
                                    </div>
                                    <!-- Reward Model -->
                                    <div
                                        class="chart-container"
                                        style="
                                            flex: 1;
                                            min-width: 280px;
                                            max-width: 400px;
                                        "
                                    >
                                        <h3
                                            class="dynamic-chart-title"
                                            style="text-align: center"
                                        >
                                            Reward Model
                                        </h3>
                                        <div
                                            class="chart-wrapper"
                                            style="padding-bottom: 60px"
                                        >
                                            <canvas
                                                id="rewardModelQABarChart"
                                            ></canvas>
                                        </div>
                                    </div>
                                </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            const { createApp, ref, onMounted, watch, computed } = Vue;

            const app = createApp({
                setup() {
                    const loading = ref(true);
                    const error = ref(null);
                    const llamaDataset = ref(null);
                    const qwenDataset = ref(null);
                    const activeTab = ref("overall");
                    const selectedDomains = ref(["overall"]); // 多选领域
                    let llamaChart = null;
                    let qwenChart = null;

                    // 比较功能相关数据
                    const selectedDatasets = ref([]);
                    const availableDatasets = ref([]);
                    const allDatasetsData = ref({});
                    // 新增：卡片折叠状态
                    const cardCollapsed = ref([]);
                    // 主卡片折叠状态
                    const mainCardCollapsed = ref(false);
                    const toggleMainCardCollapse = () => {
                        mainCardCollapsed.value = !mainCardCollapsed.value;
                    };
                    // 新增：控制原始数据集卡片显示
                    const showOriginalCard = ref(true);

                    // 搜索功能（点击按钮才过滤）
                    const searchInput = ref("");
                    const searchQuery = ref("");
                    const applySearch = () => {
                        searchQuery.value = searchInput.value;
                    };
                    const filteredDatasets = computed(() => {
                        if (!searchQuery.value.trim())
                            return availableDatasets.value;
                        const q = searchQuery.value.trim().toLowerCase();
                        return availableDatasets.value.filter((ds) => {
                            const name = getDisplayName(ds.name).toLowerCase();
                            const tags = (
                                getDatasetTags(ds).join(" ") || ""
                            ).toLowerCase();
                            return name.includes(q) || tags.includes(q);
                        });
                    });

                    // 触发checkbox点击，保证只用v-model控制
                    const triggerCheckboxClick = (id) => {
                        const checkbox = document.getElementById(
                            "compare-checkbox-" + id
                        );
                        if (checkbox) checkbox.click();
                    };

                    // 监听 selectedDatasets，保持所有卡片默认折叠
                    watch(selectedDatasets, (newVal) => {
                        cardCollapsed.value = newVal.map(() => true);
                    });

                    // 从URL参数获取数据集ID
                    const getUrlParams = () => {
                        const urlParams = new URLSearchParams(
                            window.location.search
                        );
                        const datasetId = urlParams.get("id");
                        return { datasetId };
                    };

                    // 加载数据集详情
                    const loadDatasetDetail = async () => {
                        try {
                            loading.value = true;
                            const { datasetId } = getUrlParams();

                            if (!datasetId) {
                                throw new Error("Dataset ID not specified");
                            }

                            const response = await fetch(
                                "./data/processed_merge_data.json"
                            );
                            if (!response.ok) {
                                throw new Error("Failed to load data");
                            }

                            const data = await response.json();
                            allDatasetsData.value = data; // 保存所有数据用于比较

                            // 加载两个模型的数据
                            const llamaData = data["llama"];
                            const qwenData = data["qwen"];

                            if (!llamaData || !qwenData) {
                                throw new Error("Model data not found");
                            }

                            const llamaDataset_data = llamaData.find(
                                (d) => d.id.toString() === datasetId.toString()
                            );
                            const qwenDataset_data = qwenData.find(
                                (d) => d.id.toString() === datasetId.toString()
                            );

                            if (!llamaDataset_data || !qwenDataset_data) {
                                throw new Error(
                                    "Dataset not found in both models"
                                );
                            }

                            llamaDataset.value = llamaDataset_data;
                            qwenDataset.value = qwenDataset_data;

                            // 设置可用于比较的数据集（使用llama数据）
                            // 展示所有除id为0和1的数据集
                            availableDatasets.value = llamaData.filter(
                                (d) => d.id !== 0 && d.id !== 1
                            );
                            // 默认勾选本页面id对应数据集
                            if (
                                !selectedDatasets.value.includes(
                                    llamaDataset_data.name
                                )
                            ) {
                                selectedDatasets.value.unshift(
                                    llamaDataset_data.name
                                );
                            }

                            // 更新页面标题
                            document.title = `${llamaDataset_data.name} - Dataset Details`;

                            return Promise.resolve();
                        } catch (err) {
                            console.error("Error loading dataset:", err);
                            error.value = err.message;
                            return Promise.reject(err);
                        } finally {
                            loading.value = false;
                        }
                    };

                    // 格式化分数
                    const formatScore = (score) => {
                        if (typeof score === "number") {
                            return (Math.round(score * 10) / 10).toFixed(1);
                        }
                        return "0.0";
                    };

                    // 格式化改进值
                    const formatImprovement = (improvement) => {
                        if (typeof improvement === "number") {
                            const diff = Math.round(improvement * 10) / 10;
                            return diff > 0
                                ? `+${diff.toFixed(1)}`
                                : `${diff.toFixed(1)}`;
                        }
                        return "";
                    };

                    // 获取领域显示名称
                    const getDomainDisplayName = (domain) => {
                        const domainNames = {
                            general: "General",
                            math: "Math",
                            code: "Code",
                            reasoning: "Reasoning",
                            base: "Base Model",
                        };
                        return domainNames[domain] || domain;
                    };

                    // 比较功能方法
                    // const toggleCompareMode = () => { // REMOVE
                    //     compareMode.value = !compareMode.value // REMOVE
                    //     if (!compareMode.value) { // REMOVE
                    //         clearComparison() // REMOVE
                    //     } // REMOVE
                    // } // REMOVE

                    const isDatasetSelected = (datasetName) => {
                        return selectedDatasets.value.includes(datasetName);
                    };

                    // const toggleDatasetSelection = () => {} // 不再需要

                    const clearComparison = () => {
                        selectedDatasets.value = [];
                        showOriginalCard.value = true; // 清空后恢复显示原始卡片
                        createDualRadarCharts();
                        // 清空时也重置折叠状态
                        cardCollapsed.value = [];
                    };

                    // 多选领域功能
                    const toggleDomain = (domain) => {
                        const index = selectedDomains.value.indexOf(domain);
                        if (index > -1) {
                            selectedDomains.value.splice(index, 1);
                        } else {
                            selectedDomains.value.push(domain);
                        }
                        updateCharts();
                    };

                    const updateCharts = () => {
                        if (selectedDatasets.value.length > 0) {
                            updateComparison();
                            updateEvalRadarCharts && updateEvalRadarCharts();
                        } else {
                            createDualRadarCharts();
                        }
                    };

                    const updateComparison = () => {
                        showOriginalCard.value = false; // 更新后隐藏原始卡片
                        const llamaModelData =
                            allDatasetsData.value["llama"] || [];
                        const qwenModelData =
                            allDatasetsData.value["qwen"] || [];
                        const datasetNameMapping = {
                            "meta-llama/Llama-3.1-8B-Instruct":
                                "Qwen/Qwen2.5-7B-Instruct",
                            "meta-llama/Llama-3.1-8B": "Qwen/Qwen2.5-7B",
                        };
                        // 只显示当前勾选的数据集
                        let llamaDataArrays = [];
                        let qwenDataArrays = [];
                        let llamaNames = [];
                        let qwenNames = [];
                        let chartLabels = [];
                        let chartTitle = "";
                        if (selectedDatasets.value.length > 0) {
                            selectedDatasets.value.forEach((datasetName) => {
                                const compareLlamaDataset = llamaModelData.find(
                                    (d) => d.name === datasetName
                                );
                                const qwenDatasetName =
                                    datasetNameMapping[datasetName] ||
                                    datasetName;
                                const compareQwenDataset = qwenModelData.find(
                                    (d) => d.name === qwenDatasetName
                                );
                                if (compareLlamaDataset && compareQwenDataset) {
                                    const llamaCompareData =
                                        getMultiDomainChartData(
                                            compareLlamaDataset
                                        );
                                    const qwenCompareData =
                                        getMultiDomainChartData(
                                            compareQwenDataset
                                        );
                                    llamaDataArrays.push(llamaCompareData.data);
                                    qwenDataArrays.push(qwenCompareData.data);
                                    llamaNames.push(compareLlamaDataset.name);
                                    qwenNames.push(compareQwenDataset.name);
                                    if (chartLabels.length === 0) {
                                        chartLabels = llamaCompareData.labels;
                                        chartTitle = llamaCompareData.title;
                                    }
                                }
                            });
                        }
                        // 如果没有选中任何数据集，显示空雷达图
                        if (
                            selectedDatasets.value.length === 0 ||
                            chartLabels.length === 0
                        ) {
                            chartLabels = [
                                "General",
                                "Math",
                                "Code",
                                "Reasoning",
                            ];
                            chartTitle = "Performance Overview";
                            llamaDataArrays = [];
                            qwenDataArrays = [];
                            llamaNames = [];
                            qwenNames = [];
                        }
                        llamaChart = createRadarChart(
                            "llamaRadarChart",
                            chartLabels,
                            llamaDataArrays,
                            chartTitle,
                            llamaNames,
                            llamaChart
                        );
                        qwenChart = createRadarChart(
                            "qwenRadarChart",
                            chartLabels,
                            qwenDataArrays,
                            chartTitle,
                            qwenNames,
                            qwenChart
                        );
                        // 保证折叠数组长度与选中数据集一致
                        cardCollapsed.value = selectedDatasets.value.map(
                            () => true
                        );
                    };

                    const getMultiDomainChartData = (datasetObj) => {
                        if (selectedDomains.value.length === 0) {
                            return {
                                labels: [],
                                data: [],
                                title: "No domains selected",
                            };
                        }

                        const allLabels = [];
                        const allData = [];
                        let title = "";

                        selectedDomains.value.forEach((domain) => {
                            const domainData = getChartDataForDataset(
                                datasetObj,
                                domain
                            );
                            if (domainData.labels.length > 0) {
                                allLabels.push(...domainData.labels);
                                allData.push(...domainData.data);
                                if (!title) title = domainData.title;
                            }
                        });

                        return {
                            labels: allLabels,
                            data: allData,
                            title:
                                selectedDomains.value.length > 1
                                    ? "Multi-Domain Performance"
                                    : title,
                        };
                    };

                    const getChartDataForDataset = (datasetObj, tabType) => {
                        switch (tabType) {
                            case "overall":
                                return {
                                    labels: [
                                        "General",
                                        "Math",
                                        "Code",
                                        "Reasoning",
                                    ],
                                    data: [
                                        datasetObj.general_avg || 0,
                                        datasetObj.math_avg || 0,
                                        datasetObj.code_avg || 0,
                                        datasetObj.reasoning_avg || 0,
                                    ],
                                    title: "Overall Performance",
                                };

                            case "general":
                                if (datasetObj.task_details?.general_tasks) {
                                    return {
                                        labels: datasetObj.task_details.general_tasks.map(
                                            (task) => task.task_name
                                        ),
                                        data: datasetObj.task_details.general_tasks.map(
                                            (task) =>
                                                task.metrics[0]?.score || 0
                                        ),
                                        title: "General Tasks Performance",
                                    };
                                }
                                break;

                            case "math":
                                if (datasetObj.task_details?.math_tasks) {
                                    return {
                                        labels: datasetObj.task_details.math_tasks.map(
                                            (task) => task.task_name
                                        ),
                                        data: datasetObj.task_details.math_tasks.map(
                                            (task) =>
                                                task.metrics[0]?.score || 0
                                        ),
                                        title: "Math Tasks Performance",
                                    };
                                }
                                break;

                            case "code":
                                if (datasetObj.task_details?.code_tasks) {
                                    const labels = [];
                                    const data = [];

                                    datasetObj.task_details.code_tasks.forEach(
                                        (task) => {
                                            if (
                                                task.metrics &&
                                                task.metrics.length > 1
                                            ) {
                                                task.metrics.forEach(
                                                    (metric) => {
                                                        let shortTask =
                                                            task.task_name;
                                                        if (
                                                            shortTask ===
                                                            "LiveCodeBench"
                                                        )
                                                            shortTask = "LCB";
                                                        if (
                                                            shortTask ===
                                                            "humaneval"
                                                        )
                                                            shortTask = "HE";

                                                        let shortMetric =
                                                            metric.metric
                                                                .replace(
                                                                    "lcb_",
                                                                    ""
                                                                )
                                                                .replace(
                                                                    "_",
                                                                    " "
                                                                );
                                                        if (
                                                            shortMetric ===
                                                            "code generation"
                                                        )
                                                            shortMetric = "gen";
                                                        if (
                                                            shortMetric ===
                                                            "code execution"
                                                        )
                                                            shortMetric =
                                                                "exec";
                                                        if (
                                                            shortMetric ===
                                                            "test output"
                                                        )
                                                            shortMetric =
                                                                "test";
                                                        if (
                                                            shortMetric ===
                                                            "pass@1"
                                                        )
                                                            shortMetric =
                                                                "pass";
                                                        if (
                                                            shortMetric ===
                                                            "score 3shot"
                                                        )
                                                            shortMetric =
                                                                "score";

                                                        labels.push(
                                                            `${shortTask}\n${shortMetric}`
                                                        );
                                                        data.push(
                                                            metric.score || 0
                                                        );
                                                    }
                                                );
                                            } else {
                                                let shortTask = task.task_name;
                                                if (shortTask === "humaneval")
                                                    shortTask = "HE";
                                                labels.push(shortTask);
                                                data.push(
                                                    task.metrics[0]?.score || 0
                                                );
                                            }
                                        }
                                    );

                                    return {
                                        labels,
                                        data,
                                        title: "Code Tasks Performance",
                                    };
                                }
                                break;

                            case "reasoning":
                                if (datasetObj.task_details?.reasoning_tasks) {
                                    return {
                                        labels: datasetObj.task_details.reasoning_tasks.map(
                                            (task) => task.task_name
                                        ),
                                        data: datasetObj.task_details.reasoning_tasks.map(
                                            (task) =>
                                                task.metrics[0]?.score || 0
                                        ),
                                        title: "Reasoning Tasks Performance",
                                    };
                                }
                                break;
                        }

                        return { labels: [], data: [], title: "" };
                    };

                    // 创建单个雷达图
                    const createRadarChart = (
                        canvasId,
                        labels,
                        dataArrays,
                        title,
                        names = null,
                        existingChart = null
                    ) => {
                        const ctx = document.getElementById(canvasId);
                        if (!ctx) return null;

                        // 如果已存在图表，先销毁
                        if (existingChart) {
                            existingChart.destroy();
                        }

                        // 注册datalabels插件
                        Chart.register(ChartDataLabels);

                        if (!Array.isArray(dataArrays[0])) {
                            dataArrays = [dataArrays];
                            names = names || [title];
                        }

                        const colors = [
                            {
                                bg: "rgba(30, 64, 175, 0.1)",
                                border: "rgba(30, 64, 175, 0.8)",
                                point: "rgba(30, 64, 175, 1)",
                            },
                            {
                                bg: "rgba(220, 38, 38, 0.1)",
                                border: "rgba(220, 38, 38, 0.8)",
                                point: "rgba(220, 38, 38, 1)",
                            },
                            {
                                bg: "rgba(34, 197, 94, 0.1)",
                                border: "rgba(34, 197, 94, 0.8)",
                                point: "rgba(34, 197, 94, 1)",
                            },
                            {
                                bg: "rgba(251, 146, 60, 0.1)",
                                border: "rgba(251, 146, 60, 0.8)",
                                point: "rgba(251, 146, 60, 1)",
                            },
                            {
                                bg: "rgba(168, 85, 247, 0.1)",
                                border: "rgba(168, 85, 247, 0.8)",
                                point: "rgba(168, 85, 247, 1)",
                            },
                        ];

                        const datasets = dataArrays.map((data, index) => ({
                            label: names[index] || `Dataset ${index + 1}`,
                            data: data,
                            backgroundColor: colors[index % colors.length].bg,
                            borderColor: colors[index % colors.length].border,
                            borderWidth: 2,
                            pointBackgroundColor:
                                colors[index % colors.length].point,
                            pointBorderColor: "#ffffff",
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                        }));

                        // 针对LLM-as-Judge (Q Score)和LLM-as-Judge (QA Score)雷达图自定义刻度
                        let customOptions = {};
                        if (
                            canvasId === "llmJudgeQRadarChart" ||
                            canvasId === "llmJudgeQARadarChart"
                        ) {
                            customOptions = {
                                scales: {
                                    r: {
                                        beginAtZero: true,
                                        min: 0,
                                        max: 10,
                                        ticks: {
                                            stepSize: 2,
                                            color: "#94a3b8",
                                            callback: function (value) {
                                                return [
                                                    0, 2, 4, 6, 8, 10,
                                                ].includes(value)
                                                    ? value
                                                    : "";
                                            },
                                            backdrop: {
                                                color: "transparent",
                                            },
                                        },
                                        pointLabels: {
                                            font: {
                                                size: 12,
                                                weight: "600",
                                                family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                            },
                                            color: "#000000",
                                            padding: 20,
                                            centerPointLabels: false,
                                            display: true,
                                        },
                                    },
                                },
                            };
                        } else if (canvasId === "modelEvalRadarChart") {
                            customOptions = {
                                scales: {
                                    r: {
                                        beginAtZero: true,
                                        min: 0,
                                        max: 1,
                                        ticks: {
                                            stepSize: 0.2,
                                            color: "#94a3b8",
                                            callback: function (value) {
                                                return [
                                                    0.0, 0.2, 0.4, 0.6, 0.8,
                                                    1.0,
                                                ].includes(
                                                    Number(value.toFixed(1))
                                                )
                                                    ? value.toFixed(1)
                                                    : "";
                                            },
                                            backdrop: {
                                                color: "transparent",
                                            },
                                        },
                                        pointLabels: {
                                            font: {
                                                size: 12,
                                                weight: "600",
                                                family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                            },
                                            color: "#000000",
                                            padding: 20,
                                            centerPointLabels: false,
                                            display: true,
                                        },
                                    },
                                },
                            };
                        }
                        const chart = new Chart(ctx, {
                            type: "radar",
                            data: {
                                labels: labels,
                                datasets: datasets,
                            },
                            options: Object.assign(
                                {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        legend: {
                                            display: datasets.length > 1,
                                            position: "bottom",
                                            labels: {
                                                padding: 20,
                                                usePointStyle: true,
                                                font: {
                                                    size: 12,
                                                    weight: "500",
                                                },
                                            },
                                        },
                                        datalabels: {
                                            display: datasets.length === 1, // 只有单个数据集时显示
                                            align: "end",
                                            anchor: "end",
                                            color: "#000000",
                                            font: {
                                                size: 12,
                                                weight: "600",
                                            },
                                            formatter: (value) => {
                                                return value.toFixed(1);
                                            },
                                            offset: 8,
                                        },
                                    },
                                    scales: {
                                        r: {
                                            beginAtZero: true,
                                            max: 100,
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.1)",
                                            },
                                            angleLines: {
                                                color: "rgba(30, 64, 175, 0.15)",
                                            },
                                            pointLabels: {
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                                },
                                                color: "#000000",
                                                padding: 20,
                                                centerPointLabels: false,
                                                display: true,
                                            },
                                            ticks: {
                                                stepSize: 20,
                                                color: "#94a3b8",
                                                backdrop: {
                                                    color: "transparent",
                                                },
                                            },
                                        },
                                    },
                                    layout: {
                                        padding: {
                                            top: 45,
                                            bottom: 70,
                                            left: 70,
                                            right: 70,
                                        },
                                    },
                                },
                                customOptions
                            ),
                        });
                        return chart;
                    };

                    // 新增：生成评测分数雷达图（三图）
                    const createEvalRadarCharts = (
                        llmJudgeQLabels,
                        llmJudgeQDataArrays,
                        llmJudgeQNames,
                        llmJudgeQALabels,
                        llmJudgeQADataArrays,
                        llmJudgeQANames,
                        modelEvalLabels,
                        modelEvalDataArrays,
                        modelEvalNames,
                        existingJudgeQChart,
                        existingJudgeQAChart,
                        existingModelChart
                    ) => {
                        // LLM-as-Judge (Q Score)
                        window.llmJudgeQRadarChartObj = createRadarChart(
                            "llmJudgeQRadarChart",
                            llmJudgeQLabels,
                            llmJudgeQDataArrays,
                            "LLM-as-Judge (Q Score)",
                            llmJudgeQNames,
                            existingJudgeQChart
                        );
                        // LLM-as-Judge (QA Score)
                        window.llmJudgeQARadarChartObj = createRadarChart(
                            "llmJudgeQARadarChart",
                            llmJudgeQALabels,
                            llmJudgeQADataArrays,
                            "LLM-as-Judge (QA Score)",
                            llmJudgeQANames,
                            existingJudgeQAChart
                        );
                        // Model-based Evaluation
                        window.modelEvalRadarChartObj = createRadarChart(
                            "modelEvalRadarChart",
                            modelEvalLabels,
                            modelEvalDataArrays,
                            "Model-based Evaluation",
                            modelEvalNames,
                            existingModelChart
                        );
                    };

                    // 新增：处理评测分数数据（三图）
                    const getEvalScoreData = (datasets, type) => {
                        // type: 'LLM-as-Judge-Q', 'LLM-as-Judge-QA', 'Model-based Evaluation'
                        // 返回 {labels, dataArrays, names}
                        const metricMap = {}; // {metric: [val1, val2, ...]}
                        const datasetNames = [];
                        datasets.forEach((ds) => {
                            const evalScore = ds.evaluation_score || {};
                            let metrics = {};
                            if (type === "LLM-as-Judge-Q") {
                                // 只取Q_scores.LLM-as-Judge下所有metric的mean
                                const q =
                                    evalScore.Q_scores?.["LLM-as-Judge"] || {};
                                Object.keys(q).forEach((metric) => {
                                    let mean = q[metric]?.mean;
                                    metrics[metric] =
                                        typeof mean === "number"
                                            ? Number(mean.toFixed(1))
                                            : 0;
                                });
                            } else if (type === "LLM-as-Judge-QA") {
                                // 只取QA_scores.LLM-as-Judge下所有metric的mean
                                const qa =
                                    evalScore.QA_scores?.["LLM-as-Judge"] || {};
                                Object.keys(qa).forEach((metric) => {
                                    let mean = qa[metric]?.mean;
                                    metrics[metric] =
                                        typeof mean === "number"
                                            ? Number(mean.toFixed(1))
                                            : 0;
                                });
                            } else if (type === "Model-based Evaluation") {
                                // Q_scores.Model-based Evaluation和QA_scores.Model-based Evaluation所有metric，分别展示
                                const q =
                                    evalScore.Q_scores?.[
                                        "Model-based Evaluation"
                                    ] || {};
                                const qa =
                                    evalScore.QA_scores?.[
                                        "Model-based Evaluation"
                                    ] || {};
                                // 分别处理Q_scores和QA_scores中的metric
                                Object.keys(q).forEach((metric) => {
                                    let mean = q[metric]?.mean;
                                    if (typeof mean === "number") {
                                        metrics[`${metric}`] = Number(
                                            mean.toFixed(1)
                                        );
                                    }
                                });
                                Object.keys(qa).forEach((metric) => {
                                    let mean = qa[metric]?.mean;
                                    if (typeof mean === "number") {
                                        metrics[`${metric}`] = Number(
                                            mean.toFixed(1)
                                        );
                                    }
                                });
                            }
                            // 合并到metricMap
                            Object.entries(metrics).forEach(([metric, val]) => {
                                if (!metricMap[metric]) metricMap[metric] = [];
                                metricMap[metric].push(val);
                            });
                            datasetNames.push(ds.name);
                        });
                        // labels: 所有metric
                        const labels = Object.keys(metricMap);
                        // dataArrays: 每个数据集一组
                        const dataArrays = datasetNames.map((_, i) =>
                            labels.map((metric) => metricMap[metric][i] ?? 0)
                        );
                        return { labels, dataArrays, names: datasetNames };
                    };

                    // 新增：更新评测分数雷达图（三图）
                    const updateEvalRadarCharts = () => {
                        // 获取当前选中数据集对象
                        const llamaModelData =
                            allDatasetsData.value["llama"] || [];
                        const selectedObjs = selectedDatasets.value
                            .map((name) =>
                                llamaModelData.find((d) => d.name === name)
                            )
                            .filter(Boolean);
                        // LLM-as-Judge (Q Score)
                        const judgeQ = getEvalScoreData(
                            selectedObjs,
                            "LLM-as-Judge-Q"
                        );
                        // LLM-as-Judge (QA Score)
                        const judgeQA = getEvalScoreData(
                            selectedObjs,
                            "LLM-as-Judge-QA"
                        );
                        // Model-based Evaluation
                        const modelEval = getEvalScoreData(
                            selectedObjs,
                            "Model-based Evaluation"
                        );
                        createEvalRadarCharts(
                            judgeQ.labels,
                            judgeQ.dataArrays,
                            judgeQ.names,
                            judgeQA.labels,
                            judgeQA.dataArrays,
                            judgeQA.names,
                            modelEval.labels,
                            modelEval.dataArrays,
                            modelEval.names,
                            window.llmJudgeQRadarChartObj,
                            window.llmJudgeQARadarChartObj,
                            window.modelEvalRadarChartObj
                        );
                        // 更新Clarity曲线图
                        const clarityQ = getClarityLineChartData(
                            selectedObjs,
                            "Q"
                        );
                        const clarityQA = getClarityLineChartData(
                            selectedObjs,
                            "QA"
                        );
                        createClarityLineCharts(
                            clarityQ.labels,
                            clarityQ.dataArr,
                            clarityQ.names,
                            clarityQA.labels,
                            clarityQA.dataArr,
                            clarityQA.names,
                            window.clarityQLineChartObj,
                            window.clarityQALineChartObj
                        );
                        // 更新其他指标曲线图
                        const metrics = [
                            "Coherence",
                            "Completeness",
                            "Complexity",
                            "Correctness",
                            "Meaningfulness",
                        ];
                        metrics.forEach((metric) => {
                            const q = getOtherLineChartData(
                                selectedObjs,
                                "Q",
                                metric
                            );
                            const qa = getOtherLineChartData(
                                selectedObjs,
                                "QA",
                                metric
                            );
                            createOtherLineCharts(
                                metric,
                                q.labels,
                                q.dataArr,
                                q.names,
                                qa.labels,
                                qa.dataArr,
                                qa.names,
                                window[metric.toLowerCase() + "QLineChartObj"],
                                window[metric.toLowerCase() + "QALineChartObj"]
                            );
                        });
                        // 更新OpenThoughts卡片曲线图
                        const openQ = getOpenThoughtsLineChartData(
                            selectedObjs,
                            "Q"
                        );
                        const relQA = getOpenThoughtsLineChartData(
                            selectedObjs,
                            "QA"
                        );

                        // 创建OpenThoughts (Q)线图
                        const openCtx = document.getElementById(
                            "openthoughtsQLineChart"
                        );
                        if (openCtx && window["openthoughtsQLineChartObj"])
                            window["openthoughtsQLineChartObj"].destroy();
                        if (openCtx) {
                            window["openthoughtsQLineChartObj"] = new Chart(
                                openCtx,
                                {
                                    type: "line",
                                    data: {
                                        labels: openQ.labels,
                                        datasets: openQ.dataArr.map(
                                            (data, idx) => ({
                                                label:
                                                    openQ.names[idx] ||
                                                    `Dataset ${idx + 1}`,
                                                data: data,
                                                fill: false,
                                                borderColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                backgroundColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                tension: 0.4,
                                                pointRadius: 4,
                                                pointHoverRadius: 6,
                                                borderWidth: 2,
                                            })
                                        ),
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        aspectRatio: 1.8,
                                        plugins: {
                                            legend: {
                                                display: true,
                                                position: "bottom",
                                                labels: {
                                                    padding: 30,
                                                    usePointStyle: true,
                                                    font: {
                                                        size: 12,
                                                        weight: "500",
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                callbacks: {
                                                    title: function () {
                                                        return "";
                                                    },
                                                    label: function (context) {
                                                        return (
                                                            context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                        );
                                                    },
                                                },
                                            },
                                            datalabels: {
                                                display:
                                                    openQ.dataArr.length === 1,
                                                align: "end",
                                                anchor: "end",
                                                color: "#000000",
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                },
                                                formatter: (value) => {
                                                    return value.toFixed(1);
                                                },
                                                offset: 8,
                                            },
                                        },
                                        scales: {
                                            x: {
                                                title: {
                                                    display: true,
                                                    text: "Score",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: { font: { size: 12 } },
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: "%",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                beginAtZero: true,
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: {
                                                    font: { size: 12 },
                                                    callback: (v) => v,
                                                },
                                            },
                                        },
                                        layout: {
                                            padding: {
                                                top: 30,
                                                bottom: 40,
                                                left: 30,
                                                right: 30,
                                            },
                                        },
                                    },
                                }
                            );
                        }

                        // 创建Relevance (QA)线图
                        const relCtx = document.getElementById(
                            "relevanceQALineChart"
                        );
                        if (relCtx && window["relevanceQALineChartObj"])
                            window["relevanceQALineChartObj"].destroy();
                        if (relCtx) {
                            window["relevanceQALineChartObj"] = new Chart(
                                relCtx,
                                {
                                    type: "line",
                                    data: {
                                        labels: relQA.labels,
                                        datasets: relQA.dataArr.map(
                                            (data, idx) => ({
                                                label:
                                                    relQA.names[idx] ||
                                                    `Dataset ${idx + 1}`,
                                                data: data,
                                                fill: false,
                                                borderColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                backgroundColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                tension: 0.4,
                                                pointRadius: 4,
                                                pointHoverRadius: 6,
                                                borderWidth: 2,
                                            })
                                        ),
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        aspectRatio: 1.8,
                                        plugins: {
                                            legend: {
                                                display: true,
                                                position: "bottom",
                                                labels: {
                                                    padding: 30,
                                                    usePointStyle: true,
                                                    font: {
                                                        size: 12,
                                                        weight: "500",
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                callbacks: {
                                                    title: function () {
                                                        return "";
                                                    },
                                                    label: function (context) {
                                                        return (
                                                            context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                        );
                                                    },
                                                },
                                            },
                                            datalabels: {
                                                display:
                                                    relQA.dataArr.length === 1,
                                                align: "end",
                                                anchor: "end",
                                                color: "#000000",
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                },
                                                formatter: (value) => {
                                                    return value.toFixed(1);
                                                },
                                                offset: 8,
                                            },
                                        },
                                        scales: {
                                            x: {
                                                title: {
                                                    display: true,
                                                    text: "Score",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: { font: { size: 12 } },
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: "%",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                beginAtZero: true,
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: {
                                                    font: { size: 12 },
                                                    callback: (v) => v,
                                                },
                                            },
                                        },
                                        layout: {
                                            padding: {
                                                top: 30,
                                                bottom: 40,
                                                left: 30,
                                                right: 30,
                                            },
                                        },
                                    },
                                }
                            );
                        }
                        // 更新Model-based Evaluation (Q)卡片曲线图
                        const deitaQ = getModelBasedQLineChartData(
                            selectedObjs,
                            "Deita Complexity"
                        );
                        // 处理Thinking Prob区间label
                        const thinkQ = getModelBasedQLineChartData(
                            selectedObjs,
                            "Thinking Prob"
                        );
                        let barLabels = [];
                        if (selectedObjs.length > 0) {
                            // 只要有一个数据集有数据，取第一个非空的range
                            for (let ds of selectedObjs) {
                                const q =
                                    ds?.evaluation_score?.Q_scores?.[
                                        "Model-based Evaluation"
                                    ] || {};
                                const m = q["Thinking Prob"];
                                if (
                                    m &&
                                    Array.isArray(m.range) &&
                                    m.range.length > 1
                                ) {
                                    barLabels = getThinkingProbBarChartLabels(
                                        m.range
                                    );
                                    break;
                                }
                            }
                        }
                        // 创建Deita Complexity线图
                        const deitaCtx = document.getElementById(
                            "deitaComplexityQLineChart"
                        );
                        if (deitaCtx && window["deitaComplexityQLineChartObj"])
                            window["deitaComplexityQLineChartObj"].destroy();
                        if (deitaCtx) {
                            window["deitaComplexityQLineChartObj"] = new Chart(
                                deitaCtx,
                                {
                                    type: "line",
                                    data: {
                                        labels: deitaQ.labels,
                                        datasets: deitaQ.dataArr.map(
                                            (data, idx) => ({
                                                label:
                                                    deitaQ.names[idx] ||
                                                    `Dataset ${idx + 1}`,
                                                data: data,
                                                fill: false,
                                                borderColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                backgroundColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                tension: 0.4,
                                                pointRadius: 4,
                                                pointHoverRadius: 6,
                                                borderWidth: 2,
                                            })
                                        ),
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        aspectRatio: 1.8,
                                        plugins: {
                                            legend: {
                                                display: true,
                                                position: "bottom",
                                                labels: {
                                                    padding: 30,
                                                    usePointStyle: true,
                                                    font: {
                                                        size: 12,
                                                        weight: "500",
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                callbacks: {
                                                    title: function () {
                                                        return "";
                                                    },
                                                    label: function (context) {
                                                        return (
                                                            context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                        );
                                                    },
                                                },
                                            },
                                            datalabels: {
                                                display:
                                                    deitaQ.dataArr.length === 1,
                                                align: "end",
                                                anchor: "end",
                                                color: "#000000",
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                },
                                                formatter: (value) => {
                                                    return value.toFixed(1);
                                                },
                                                offset: 8,
                                            },
                                        },
                                        scales: {
                                            x: {
                                                title: {
                                                    display: true,
                                                    text: "Score",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: { font: { size: 12 } },
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: "%",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                beginAtZero: true,
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: {
                                                    font: { size: 12 },
                                                    callback: (v) => v,
                                                },
                                            },
                                        },
                                        layout: {
                                            padding: {
                                                top: 30,
                                                bottom: 40,
                                                left: 30,
                                                right: 30,
                                            },
                                        },
                                    },
                                }
                            );
                        }
                        createThinkingProbBarChart(
                            barLabels,
                            thinkQ.dataArr,
                            thinkQ.names,
                            window["thinkingProbQLineChartObj"]
                        );

                        // 更新Model-based Evaluation (QA)卡片图表
                        const deitaQualityQA = getModelBasedQALineChartData(
                            selectedObjs,
                            "Deita Quality"
                        );
                        const ifdQA = getModelBasedQALineChartData(
                            selectedObjs,
                            "IFD"
                        );
                        const rewardModelQA = getModelBasedQALineChartData(
                            selectedObjs,
                            "Reward Model"
                        );
                        createModelBasedQACharts(
                            deitaQualityQA,
                            ifdQA,
                            rewardModelQA
                        );
                    };

                    // 计算Heuristic表格数据，随selectedDatasets同步
                    const selectedHeuristicDatasets = computed(() => {
                        return selectedDatasets.value
                            .map((name) => {
                                const ds = getDatasetByName(name);
                                if (!ds) return null;
                                const aLength =
                                    ds?.evaluation_score?.QA_scores?.Heuristic
                                        ?.A_Length;
                                return {
                                    name: ds.name,
                                    min: aLength?.min || "-",
                                    max: aLength?.max || "-",
                                    avg: aLength?.avg || "-",
                                };
                            })
                            .filter(Boolean);
                    });

                    const getChartData = (tabType) => {
                        if (!llamaDataset.value)
                            return { labels: [], data: [], title: "" };
                        return getChartDataForDataset(
                            llamaDataset.value,
                            tabType
                        );
                    };

                    const initializeChart = () => {
                        createDualRadarCharts();
                    };

                    onMounted(() => {
                        loadDatasetDetail().then(() => {
                            setTimeout(() => {
                                initializeChart();
                                updateEvalRadarCharts();
                                // 初始化Clarity曲线图
                                // (updateEvalRadarCharts已包含)
                            }, 100);
                        });
                    });

                    const getDatasetTags = (dataset) => {
                        const tags = [];

                        const tagStr = dataset.tag || "";
                        if (tagStr) {
                            const parsedTags = tagStr
                                .split(",")
                                .map((t) => t.trim())
                                .filter((t) => t);
                            tags.push(...parsedTags);
                        }

                        return tags;
                    };

                    const getTagIcon = (tag) => {
                        const tagIcons = {
                            general: "fas fa-book",
                            math: "fas fa-calculator",
                            code: "fas fa-code",
                            science: "fas fa-flask",
                            reasoning: "fas fa-brain",
                        };

                        return tagIcons[tag.toLowerCase()] || "fas fa-tag";
                    };

                    const getTagDisplayName = (tag) => {
                        if (!tag) return "";
                        return (
                            tag.charAt(0).toUpperCase() +
                            tag.slice(1).toLowerCase()
                        );
                    };

                    const getDisplayName = (datasetName) => {
                        const displayNameMapping = {
                            "meta-llama/Llama-3.1-8B-Instruct":
                                "Instruct Model",
                            "meta-llama/Llama-3.1-8B": "Base Model",
                            "Qwen/Qwen2.5-7B-Instruct": "Instruct Model",
                            "Qwen/Qwen2.5-7B": "Base Model",
                        };
                        return displayNameMapping[datasetName] || datasetName;
                    };

                    // 获取数据集对象
                    const getDatasetByName = (name) => {
                        const llamaModelData =
                            allDatasetsData.value["llama"] || [];
                        return (
                            llamaModelData.find((d) => d.name === name) || {}
                        );
                    };

                    // 切换卡片折叠
                    const toggleCardCollapse = (idx) => {
                        cardCollapsed.value[idx] = !cardCollapsed.value[idx];
                    };

                    // 清空搜索
                    const clearSearch = () => {
                        searchInput.value = "";
                        searchQuery.value = "";
                    };

                    // chartColorBase与comparison.html完全一致
                    const chartColorBase = [
                        { rgb: "0, 82, 204" },
                        { rgb: "200, 30, 38" },
                        { rgb: "0, 128, 64" },
                        { rgb: "204, 102, 0" },
                        { rgb: "54, 54, 150" },
                        { rgb: "204, 153, 0" },
                        { rgb: "110, 36, 150" },
                    ];
                    // 获取卡片样式（背景色、白字、无边框）
                    const getCardStyle = (idx) => {
                        const rgb =
                            chartColorBase[idx % chartColorBase.length].rgb;
                        return {
                            background: `rgba(${rgb}, 1)`,
                            color: "#fff",
                            border: "none",
                            boxShadow: "0 2px 8px 0 rgba(30,64,175,0.04)",
                        };
                    };
                    // header同body
                    const getCardHeaderStyle = (idx) => getCardStyle(idx);

                    // 生成Clarity曲线图
                    const createClarityLineCharts = (
                        qLabels,
                        qData,
                        qNames,
                        qaLabels,
                        qaData,
                        qaNames,
                        existingQChart,
                        existingQAChart
                    ) => {
                        // Clarity (Q)
                        const ctxQ =
                            document.getElementById("clarityQLineChart");
                        if (ctxQ && existingQChart) existingQChart.destroy();
                        if (ctxQ) {
                            window.clarityQLineChartObj = new Chart(ctxQ, {
                                type: "line",
                                data: {
                                    labels: qLabels,
                                    datasets: qData.map((data, idx) => ({
                                        label:
                                            qNames[idx] || `Dataset ${idx + 1}`,
                                        data: data,
                                        fill: false,
                                        borderColor:
                                            getCardStyle(idx).background,
                                        backgroundColor:
                                            getCardStyle(idx).background,
                                        tension: 0.4,
                                        pointRadius: 4,
                                        pointHoverRadius: 6,
                                        borderWidth: 2,
                                    })),
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    aspectRatio: 1.8,
                                    plugins: {
                                        legend: {
                                            display: true,
                                            position: "bottom",
                                            labels: {
                                                padding: 30,
                                                usePointStyle: true,
                                                font: {
                                                    size: 12,
                                                    weight: "500",
                                                },
                                            },
                                        },
                                        tooltip: {
                                            callbacks: {
                                                title: function () {
                                                    return "";
                                                },
                                                label: function (context) {
                                                    return (
                                                        context.dataset.label +
                                                        ": (" +
                                                        context.label +
                                                        ", " +
                                                        context.parsed.y +
                                                        "%)"
                                                    );
                                                },
                                            },
                                        },
                                        datalabels: {
                                            display: qData.length === 1, // 只有单个数据集时显示
                                            align: "end",
                                            anchor: "end",
                                            color: "#000000",
                                            font: {
                                                size: 12,
                                                weight: "600",
                                            },
                                            formatter: (value) => {
                                                return value.toFixed(1);
                                            },
                                            offset: 8,
                                        },
                                    },
                                    scales: {
                                        x: {
                                            title: {
                                                display: true,
                                                text: "Score",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: { font: { size: 12 } },
                                        },
                                        y: {
                                            title: {
                                                display: true,
                                                text: "%",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            beginAtZero: true,
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: {
                                                font: { size: 12 },
                                                callback: (v) => v,
                                            },
                                        },
                                    },
                                    layout: {
                                        padding: {
                                            top: 30,
                                            bottom: 40,
                                            left: 30,
                                            right: 30,
                                        },
                                    },
                                },
                            });
                        }
                        // Clarity (QA)
                        const ctxQA =
                            document.getElementById("clarityQALineChart");
                        if (ctxQA && existingQAChart) existingQAChart.destroy();
                        if (ctxQA) {
                            window.clarityQALineChartObj = new Chart(ctxQA, {
                                type: "line",
                                data: {
                                    labels: qaLabels,
                                    datasets: qaData.map((data, idx) => ({
                                        label:
                                            qaNames[idx] ||
                                            `Dataset ${idx + 1}`,
                                        data: data,
                                        fill: false,
                                        borderColor:
                                            getCardStyle(idx).background,
                                        backgroundColor:
                                            getCardStyle(idx).background,
                                        tension: 0.4,
                                        pointRadius: 4,
                                        pointHoverRadius: 6,
                                        borderWidth: 2,
                                    })),
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    aspectRatio: 1.8,
                                    plugins: {
                                        legend: {
                                            display: true,
                                            position: "bottom",
                                            labels: {
                                                padding: 30,
                                                usePointStyle: true,
                                                font: {
                                                    size: 12,
                                                    weight: "500",
                                                },
                                            },
                                        },
                                        tooltip: {
                                            callbacks: {
                                                title: function () {
                                                    return "";
                                                },
                                                label: function (context) {
                                                    return (
                                                        context.dataset.label +
                                                        ": (" +
                                                        context.label +
                                                        ", " +
                                                        context.parsed.y +
                                                        "%)"
                                                    );
                                                },
                                            },
                                        },
                                        datalabels: {
                                            display: qaData.length === 1, // 只有单个数据集时显示
                                            align: "end",
                                            anchor: "end",
                                            color: "#000000",
                                            font: {
                                                size: 12,
                                                weight: "600",
                                            },
                                            formatter: (value) => {
                                                return value.toFixed(1);
                                            },
                                            offset: 8,
                                        },
                                    },
                                    scales: {
                                        x: {
                                            title: {
                                                display: true,
                                                text: "Score",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: { font: { size: 12 } },
                                        },
                                        y: {
                                            title: {
                                                display: true,
                                                text: "%",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            beginAtZero: true,
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: {
                                                font: { size: 12 },
                                                callback: (v) => v,
                                            },
                                        },
                                    },
                                    layout: {
                                        padding: {
                                            top: 30,
                                            bottom: 40,
                                            left: 30,
                                            right: 30,
                                        },
                                    },
                                },
                            });
                        }
                    };

                    // 生成其他指标曲线图
                    const createOtherLineCharts = (
                        metricName,
                        qLabels,
                        qData,
                        qNames,
                        qaLabels,
                        qaData,
                        qaNames,
                        existingQChart,
                        existingQAChart
                    ) => {
                        // Q Score
                        const ctxQ = document.getElementById(
                            metricName.toLowerCase() + "QLineChart"
                        );
                        if (ctxQ && existingQChart) existingQChart.destroy();
                        if (ctxQ) {
                            window[metricName.toLowerCase() + "QLineChartObj"] =
                                new Chart(ctxQ, {
                                    type: "line",
                                    data: {
                                        labels: qLabels,
                                        datasets: qData.map((data, idx) => ({
                                            label:
                                                qNames[idx] ||
                                                `Dataset ${idx + 1}`,
                                            data: data,
                                            fill: false,
                                            borderColor:
                                                getCardStyle(idx).background,
                                            backgroundColor:
                                                getCardStyle(idx).background,
                                            tension: 0.4,
                                            pointRadius: 4,
                                            pointHoverRadius: 6,
                                            borderWidth: 2,
                                        })),
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        aspectRatio: 1.8,
                                        plugins: {
                                            legend: {
                                                display: true,
                                                position: "bottom",
                                                labels: {
                                                    padding: 30,
                                                    usePointStyle: true,
                                                    font: {
                                                        size: 12,
                                                        weight: "500",
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                callbacks: {
                                                    title: function () {
                                                        return "";
                                                    },
                                                    label: function (context) {
                                                        return (
                                                            context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                        );
                                                    },
                                                },
                                            },
                                            datalabels: {
                                                display: qData.length === 1, // 只有单个数据集时显示
                                                align: "end",
                                                anchor: "end",
                                                color: "#000000",
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                },
                                                formatter: (value) => {
                                                    return value.toFixed(1);
                                                },
                                                offset: 8,
                                            },
                                        },
                                        scales: {
                                            x: {
                                                title: {
                                                    display: true,
                                                    text: "Score",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: { font: { size: 12 } },
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: "%",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                beginAtZero: true,
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: {
                                                    font: { size: 12 },
                                                    callback: (v) => v,
                                                },
                                            },
                                        },
                                        layout: {
                                            padding: {
                                                top: 30,
                                                bottom: 40,
                                                left: 30,
                                                right: 30,
                                            },
                                        },
                                    },
                                });
                        }
                        // QA Score
                        const ctxQA = document.getElementById(
                            metricName.toLowerCase() + "QALineChart"
                        );
                        if (ctxQA && existingQAChart) existingQAChart.destroy();
                        if (ctxQA) {
                            window[
                                metricName.toLowerCase() + "QALineChartObj"
                            ] = new Chart(ctxQA, {
                                type: "line",
                                data: {
                                    labels: qaLabels,
                                    datasets: qaData.map((data, idx) => ({
                                        label:
                                            qaNames[idx] ||
                                            `Dataset ${idx + 1}`,
                                        data: data,
                                        fill: false,
                                        borderColor:
                                            getCardStyle(idx).background,
                                        backgroundColor:
                                            getCardStyle(idx).background,
                                        tension: 0.4,
                                        pointRadius: 4,
                                        pointHoverRadius: 6,
                                        borderWidth: 2,
                                    })),
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    aspectRatio: 1.8,
                                    plugins: {
                                        legend: {
                                            display: true,
                                            position: "bottom",
                                            labels: {
                                                padding: 30,
                                                usePointStyle: true,
                                                font: {
                                                    size: 12,
                                                    weight: "500",
                                                },
                                            },
                                        },
                                        tooltip: {
                                            callbacks: {
                                                title: function () {
                                                    return "";
                                                },
                                                label: function (context) {
                                                    return (
                                                        context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                    );
                                                },
                                            },
                                        },
                                        datalabels: {
                                            display: qaData.length === 1, // 只有单个数据集时显示
                                            align: "end",
                                            anchor: "end",
                                            color: "#000000",
                                            font: {
                                                size: 12,
                                                weight: "600",
                                            },
                                            formatter: (value) => {
                                                return value.toFixed(1);
                                            },
                                            offset: 8,
                                        },
                                    },
                                    scales: {
                                        x: {
                                            title: {
                                                display: true,
                                                text: "Score",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: { font: { size: 12 } },
                                        },
                                        y: {
                                            title: {
                                                display: true,
                                                text: "%",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            beginAtZero: true,
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: {
                                                font: { size: 12 },
                                                callback: (v) => v,
                                            },
                                        },
                                    },
                                    layout: {
                                        padding: {
                                            top: 30,
                                            bottom: 40,
                                            left: 30,
                                            right: 30,
                                        },
                                    },
                                },
                            });
                        }
                    };

                    // 计算其他指标曲线图数据
                    const getOtherLineChartData = (
                        datasets,
                        type,
                        metricName
                    ) => {
                        // type: 'Q' or 'QA', metricName: 'Coherence', 'Completeness', etc.
                        const labelsArr = [];
                        const dataArr = [];
                        const names = [];
                        datasets.forEach((ds) => {
                            let metric = null;
                            if (type === "Q")
                                metric =
                                    ds?.evaluation_score?.Q_scores?.[
                                        "LLM-as-Judge"
                                    ]?.[metricName];
                            else if (type === "QA")
                                metric =
                                    ds?.evaluation_score?.QA_scores?.[
                                        "LLM-as-Judge"
                                    ]?.[metricName];
                            if (
                                metric &&
                                Array.isArray(metric.range) &&
                                Array.isArray(metric.distribution)
                            ) {
                                labelsArr.push(metric.range);
                                dataArr.push(metric.distribution);
                                names.push(ds.name);
                            } else {
                                // 空数据
                                labelsArr.push([]);
                                dataArr.push([]);
                                names.push(ds.name);
                            }
                        });
                        // 只要有一个数据集有数据，labels用第一个非空的
                        let labels = [];
                        for (let arr of labelsArr) {
                            if (arr.length) {
                                labels = arr;
                                break;
                            }
                        }
                        return { labels, dataArr, names };
                    };

                    // 计算Clarity曲线图数据
                    const getClarityLineChartData = (datasets, type) => {
                        // type: 'Q' or 'QA'
                        const labelsArr = [];
                        const dataArr = [];
                        const names = [];
                        datasets.forEach((ds) => {
                            let clarity = null;
                            if (type === "Q")
                                clarity =
                                    ds?.evaluation_score?.Q_scores?.[
                                        "LLM-as-Judge"
                                    ]?.Clarity;
                            else if (type === "QA")
                                clarity =
                                    ds?.evaluation_score?.QA_scores?.[
                                        "LLM-as-Judge"
                                    ]?.Clarity;
                            if (
                                clarity &&
                                Array.isArray(clarity.range) &&
                                Array.isArray(clarity.distribution)
                            ) {
                                labelsArr.push(clarity.range);
                                dataArr.push(clarity.distribution);
                                names.push(ds.name);
                            } else {
                                // 空数据
                                labelsArr.push([]);
                                dataArr.push([]);
                                names.push(ds.name);
                            }
                        });
                        // 只要有一个数据集有数据，labels用第一个非空的
                        let labels = [];
                        for (let arr of labelsArr) {
                            if (arr.length) {
                                labels = arr;
                                break;
                            }
                        }
                        return { labels, dataArr, names };
                    };

                    // 新增：卡片折叠状态
                    const expandedCards = ref({
                        llmjudge: false,
                        clarity: false,
                        coherence: false,
                        completeness: false,
                        complexity: false,
                        correctness: false,
                        meaningfulness: false,
                        openthoughts: false,
                        modelevaluation: false,
                        modelbasedq: false,
                        modelbasedqa: false,
                    });

                    const toggleCard = (key) => {
                        expandedCards.value[key] = !expandedCards.value[key];
                    };

                    // 计算OpenThoughts和Relevance曲线图数据
                    const getOpenThoughtsLineChartData = (datasets, type) => {
                        // type: 'Q' or 'QA'
                        const labelsArr = [];
                        const dataArr = [];
                        const names = [];
                        datasets.forEach((ds) => {
                            let metric = null;
                            if (type === "Q")
                                metric =
                                    ds?.evaluation_score?.Q_scores?.[
                                        "LLM-as-Judge"
                                    ]?.OpenThoughts;
                            else if (type === "QA")
                                metric =
                                    ds?.evaluation_score?.QA_scores?.[
                                        "LLM-as-Judge"
                                    ]?.Relevance;
                            if (
                                metric &&
                                Array.isArray(metric.range) &&
                                Array.isArray(metric.distribution)
                            ) {
                                labelsArr.push(metric.range);
                                dataArr.push(metric.distribution);
                                names.push(ds.name);
                            } else {
                                // 空数据
                                labelsArr.push([]);
                                dataArr.push([]);
                                names.push(ds.name);
                            }
                        });
                        // 只要有一个数据集有数据，labels用第一个非空的
                        let labels = [];
                        for (let arr of labelsArr) {
                            if (arr.length) {
                                labels = arr;
                                break;
                            }
                        }
                        return { labels, dataArr, names };
                    };

                    // 计算Model-based Evaluation (Q)卡片曲线图数据
                    const getModelBasedQLineChartData = (datasets, metric) => {
                        // metric: 'Deita Complexity' or 'Thinking Prob'
                        const labelsArr = [];
                        const dataArr = [];
                        const names = [];
                        datasets.forEach((ds) => {
                            const q =
                                ds?.evaluation_score?.Q_scores?.[
                                    "Model-based Evaluation"
                                ] || {};
                            const m = q[metric];
                            if (
                                m &&
                                Array.isArray(m.range) &&
                                Array.isArray(m.distribution)
                            ) {
                                if (metric === "Deita Complexity") {
                                    // x轴: 1,2,3,4,5,6
                                    labelsArr.push([1, 2, 3, 4, 5, 6]);
                                    dataArr.push(m.distribution);
                                    names.push(ds.name);
                                } else if (metric === "Thinking Prob") {
                                    // x轴: (range[i]+range[i+1])/2, i=0..5, 保留一位小数
                                    const xLabels = [];
                                    for (let i = 0; i < 6; i++) {
                                        if (
                                            typeof m.range[i] === "number" &&
                                            typeof m.range[i + 1] === "number"
                                        ) {
                                            xLabels.push(
                                                Number(
                                                    (
                                                        (m.range[i] +
                                                            m.range[i + 1]) /
                                                        2
                                                    ).toFixed(1)
                                                )
                                            );
                                        } else {
                                            xLabels.push("");
                                        }
                                    }
                                    labelsArr.push(xLabels);
                                    dataArr.push(m.distribution);
                                    names.push(ds.name);
                                }
                            } else {
                                // 空数据
                                if (metric === "Deita Complexity")
                                    labelsArr.push([1, 2, 3, 4, 5, 6]);
                                else if (metric === "Thinking Prob")
                                    labelsArr.push([
                                        0, 0.2, 0.4, 0.6, 0.8, 1.0,
                                    ]);
                                dataArr.push([]);
                                names.push(ds.name);
                            }
                        });
                        // 只要有一个数据集有数据，labels用第一个非空的
                        let labels = [];
                        for (let arr of labelsArr) {
                            if (arr.length && arr.some((x) => x !== "")) {
                                labels = arr;
                                break;
                            }
                        }
                        return { labels, dataArr, names };
                    };

                    // 计算Thinking Prob柱状图区间label
                    const getThinkingProbBarChartLabels = (range) => {
                        if (!Array.isArray(range) || range.length < 2)
                            return [];
                        const labels = [];
                        for (let i = 0; i < range.length - 1; i++) {
                            labels.push(`[${range[i]}, ${range[i + 1]})`);
                        }
                        return labels;
                    };

                    // 计算Model-based Evaluation (QA)卡片数据
                    const getModelBasedQALineChartData = (datasets, metric) => {
                        // metric: 'Deita Quality', 'IFD', 'Reward Model'
                        const labelsArr = [];
                        const dataArr = [];
                        const names = [];
                        datasets.forEach((ds) => {
                            const qa =
                                ds?.evaluation_score?.QA_scores?.[
                                    "Model-based Evaluation"
                                ] || {};
                            const m = qa[metric];
                            if (
                                m &&
                                Array.isArray(m.range) &&
                                Array.isArray(m.distribution)
                            ) {
                                if (metric === "Deita Quality") {
                                    // 线图：使用range作为x轴标签
                                    labelsArr.push(m.range);
                                    dataArr.push(m.distribution);
                                    names.push(ds.name);
                                } else if (
                                    metric === "IFD" ||
                                    metric === "Reward Model"
                                ) {
                                    // 柱状图：使用区间标签
                                    const intervalLabels = [];
                                    for (
                                        let i = 0;
                                        i < m.range.length - 1;
                                        i++
                                    ) {
                                        intervalLabels.push(
                                            `[${m.range[i]}, ${m.range[i + 1]})`
                                        );
                                    }
                                    labelsArr.push(intervalLabels);
                                    dataArr.push(m.distribution);
                                    names.push(ds.name);
                                }
                            } else {
                                // 空数据
                                if (metric === "Deita Quality") {
                                    labelsArr.push([]);
                                    dataArr.push([]);
                                } else if (
                                    metric === "IFD" ||
                                    metric === "Reward Model"
                                ) {
                                    labelsArr.push([]);
                                    dataArr.push([]);
                                }
                                names.push(ds.name);
                            }
                        });
                        // 只要有一个数据集有数据，labels用第一个非空的
                        let labels = [];
                        for (let arr of labelsArr) {
                            if (arr.length && arr.some((x) => x !== "")) {
                                labels = arr;
                                break;
                            }
                        }
                        return { labels, dataArr, names };
                    };

                    // 生成Model-based Evaluation (QA)卡片的图表
                    const createModelBasedQACharts = (
                        deitaQualityData,
                        ifdData,
                        rewardModelData
                    ) => {
                        // 创建Deita Quality线图
                        const deitaQualityCtx = document.getElementById(
                            "deitaQualityQALineChart"
                        );
                        if (
                            deitaQualityCtx &&
                            window["deitaQualityQALineChartObj"]
                        )
                            window["deitaQualityQALineChartObj"].destroy();
                        if (deitaQualityCtx) {
                            window["deitaQualityQALineChartObj"] = new Chart(
                                deitaQualityCtx,
                                {
                                    type: "line",
                                    data: {
                                        labels: deitaQualityData.labels,
                                        datasets: deitaQualityData.dataArr.map(
                                            (data, idx) => ({
                                                label:
                                                    deitaQualityData.names[
                                                        idx
                                                    ] || `Dataset ${idx + 1}`,
                                                data: data,
                                                fill: false,
                                                borderColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                backgroundColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                tension: 0.4,
                                                pointRadius: 4,
                                                pointHoverRadius: 6,
                                                borderWidth: 2,
                                            })
                                        ),
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        aspectRatio: 1.8,
                                        plugins: {
                                            legend: {
                                                display: true,
                                                position: "bottom",
                                                labels: {
                                                    padding: 30,
                                                    usePointStyle: true,
                                                    font: {
                                                        size: 12,
                                                        weight: "500",
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                callbacks: {
                                                    title: function () {
                                                        return "";
                                                    },
                                                    label: function (context) {
                                                        return (
                                                            context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                        );
                                                    },
                                                },
                                            },
                                            datalabels: {
                                                display:
                                                    deitaQualityData.dataArr
                                                        .length === 1,
                                                align: "end",
                                                anchor: "end",
                                                color: "#000000",
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                },
                                                formatter: (value) => {
                                                    return value.toFixed(1);
                                                },
                                                offset: 8,
                                            },
                                        },
                                        scales: {
                                            x: {
                                                title: {
                                                    display: true,
                                                    text: "Score",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: { font: { size: 12 } },
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: "%",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                beginAtZero: true,
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: {
                                                    font: { size: 12 },
                                                    callback: (v) => v,
                                                },
                                            },
                                        },
                                        layout: {
                                            padding: {
                                                top: 30,
                                                bottom: 40,
                                                left: 30,
                                                right: 30,
                                            },
                                        },
                                    },
                                }
                            );
                        }

                        // 创建IFD柱状图
                        const ifdCtx = document.getElementById("ifdQABarChart");
                        if (ifdCtx && window["ifdQABarChartObj"])
                            window["ifdQABarChartObj"].destroy();
                        if (ifdCtx) {
                            window["ifdQABarChartObj"] = new Chart(ifdCtx, {
                                type: "bar",
                                data: {
                                    labels: ifdData.labels,
                                    datasets: ifdData.dataArr.map(
                                        (data, idx) => ({
                                            label:
                                                ifdData.names[idx] ||
                                                `Dataset ${idx + 1}`,
                                            data: data,
                                            backgroundColor:
                                                getCardStyle(idx).background,
                                            borderColor:
                                                getCardStyle(idx).background,
                                            borderWidth: 1,
                                            borderRadius: 6,
                                            barPercentage: 0.7,
                                            categoryPercentage: 0.7,
                                        })
                                    ),
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    aspectRatio: 1.8,
                                    plugins: {
                                        legend: {
                                            display: true,
                                            position: "bottom",
                                            labels: {
                                                padding: 30,
                                                usePointStyle: true,
                                                font: {
                                                    size: 12,
                                                    weight: "500",
                                                },
                                            },
                                        },
                                        tooltip: {
                                            callbacks: {
                                                title: function () {
                                                    return "";
                                                },
                                                label: function (context) {
                                                    return (
                                                        context.dataset.label +
                                                        ": (" +
                                                        context.label +
                                                        ", " +
                                                        context.parsed.y +
                                                        "%)"
                                                    );
                                                },
                                            },
                                        },
                                        datalabels: {
                                            display:
                                                ifdData.dataArr.length === 1,
                                            align: "end",
                                            anchor: "end",
                                            color: "#000000",
                                            font: {
                                                size: 12,
                                                weight: "600",
                                            },
                                            formatter: (value) => {
                                                return value.toFixed(1);
                                            },
                                            offset: 8,
                                        },
                                    },
                                    scales: {
                                        x: {
                                            title: {
                                                display: true,
                                                text: "Score",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: { font: { size: 12 } },
                                        },
                                        y: {
                                            title: {
                                                display: true,
                                                text: "%",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            beginAtZero: true,
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: {
                                                font: { size: 12 },
                                                callback: (v) => v,
                                            },
                                        },
                                    },
                                    layout: {
                                        padding: {
                                            top: 30,
                                            bottom: 40,
                                            left: 30,
                                            right: 30,
                                        },
                                    },
                                },
                            });
                        }

                        // 创建Reward Model柱状图
                        const rewardModelCtx = document.getElementById(
                            "rewardModelQABarChart"
                        );
                        if (
                            rewardModelCtx &&
                            window["rewardModelQABarChartObj"]
                        )
                            window["rewardModelQABarChartObj"].destroy();
                        if (rewardModelCtx) {
                            window["rewardModelQABarChartObj"] = new Chart(
                                rewardModelCtx,
                                {
                                    type: "bar",
                                    data: {
                                        labels: rewardModelData.labels,
                                        datasets: rewardModelData.dataArr.map(
                                            (data, idx) => ({
                                                label:
                                                    rewardModelData.names[
                                                        idx
                                                    ] || `Dataset ${idx + 1}`,
                                                data: data,
                                                backgroundColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                borderColor:
                                                    getCardStyle(idx)
                                                        .background,
                                                borderWidth: 1,
                                                borderRadius: 6,
                                                barPercentage: 0.7,
                                                categoryPercentage: 0.7,
                                            })
                                        ),
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        aspectRatio: 1.8,
                                        plugins: {
                                            legend: {
                                                display: true,
                                                position: "bottom",
                                                labels: {
                                                    padding: 30,
                                                    usePointStyle: true,
                                                    font: {
                                                        size: 12,
                                                        weight: "500",
                                                    },
                                                },
                                            },
                                            tooltip: {
                                                callbacks: {
                                                    title: function () {
                                                        return "";
                                                    },
                                                    label: function (context) {
                                                        return (
                                                            context.dataset
                                                                .label +
                                                            ": (" +
                                                            context.label +
                                                            ", " +
                                                            context.parsed.y +
                                                            "%)"
                                                        );
                                                    },
                                                },
                                            },
                                            datalabels: {
                                                display:
                                                    rewardModelData.dataArr
                                                        .length === 1,
                                                align: "end",
                                                anchor: "end",
                                                color: "#000000",
                                                font: {
                                                    size: 12,
                                                    weight: "600",
                                                },
                                                formatter: (value) => {
                                                    return value.toFixed(1);
                                                },
                                                offset: 8,
                                            },
                                        },
                                        scales: {
                                            x: {
                                                title: {
                                                    display: true,
                                                    text: "Score",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: { font: { size: 12 } },
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: "%",
                                                    font: {
                                                        size: 13,
                                                        weight: "600",
                                                    },
                                                },
                                                beginAtZero: true,
                                                grid: {
                                                    color: "rgba(30, 64, 175, 0.08)",
                                                },
                                                ticks: {
                                                    font: { size: 12 },
                                                    callback: (v) => v,
                                                },
                                            },
                                        },
                                        layout: {
                                            padding: {
                                                top: 30,
                                                bottom: 40,
                                                left: 30,
                                                right: 30,
                                            },
                                        },
                                    },
                                }
                            );
                        }
                    };

                    // 生成Model-based Evaluation (Q)卡片的柱状图
                    const createThinkingProbBarChart = (
                        labels,
                        dataArr,
                        names,
                        existingChart
                    ) => {
                        const ctx = document.getElementById(
                            "thinkingProbQLineChart"
                        );
                        if (ctx && existingChart) existingChart.destroy();
                        if (ctx) {
                            window.thinkingProbQLineChartObj = new Chart(ctx, {
                                type: "bar",
                                data: {
                                    labels: labels,
                                    datasets: dataArr.map((data, idx) => ({
                                        label:
                                            names[idx] || `Dataset ${idx + 1}`,
                                        data: data,
                                        backgroundColor:
                                            getCardStyle(idx).background,
                                        borderColor:
                                            getCardStyle(idx).background,
                                        borderWidth: 1,
                                        borderRadius: 6,
                                        barPercentage: 0.7,
                                        categoryPercentage: 0.7,
                                    })),
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    aspectRatio: 1.8,
                                    plugins: {
                                        legend: {
                                            display: true,
                                            position: "bottom",
                                            labels: {
                                                padding: 30,
                                                usePointStyle: true,
                                                font: {
                                                    size: 12,
                                                    weight: "500",
                                                },
                                            },
                                        },
                                        tooltip: {
                                            callbacks: {
                                                title: function () {
                                                    return "";
                                                },
                                                label: function (context) {
                                                    return (
                                                        context.dataset.label +
                                                        ": (" +
                                                        context.label +
                                                        ", " +
                                                        context.parsed.y +
                                                        "%)"
                                                    );
                                                },
                                            },
                                        },
                                        datalabels: {
                                            display: dataArr.length === 1,
                                            align: "end",
                                            anchor: "end",
                                            color: "#000000",
                                            font: {
                                                size: 12,
                                                weight: "600",
                                            },
                                            formatter: (value) => {
                                                return value.toFixed(1);
                                            },
                                            offset: 8,
                                        },
                                    },
                                    scales: {
                                        x: {
                                            title: {
                                                display: true,
                                                text: "Score",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: { font: { size: 12 } },
                                        },
                                        y: {
                                            title: {
                                                display: true,
                                                text: "%",
                                                font: {
                                                    size: 13,
                                                    weight: "600",
                                                },
                                            },
                                            beginAtZero: true,
                                            grid: {
                                                color: "rgba(30, 64, 175, 0.08)",
                                            },
                                            ticks: {
                                                font: { size: 12 },
                                                callback: (v) => v,
                                            },
                                        },
                                    },
                                    layout: {
                                        padding: {
                                            top: 30,
                                            bottom: 40,
                                            left: 30,
                                            right: 30,
                                        },
                                    },
                                },
                            });
                        }
                    };

                    return {
                        loading,
                        error,
                        llamaDataset,
                        qwenDataset,
                        activeTab,
                        selectedDomains,
                        formatScore,
                        formatImprovement,
                        getDomainDisplayName,
                        toggleDomain,
                        // compareMode, // REMOVE
                        selectedDatasets,
                        availableDatasets,
                        // toggleCompareMode, // REMOVE
                        isDatasetSelected,
                        // toggleDatasetSelection, // REMOVE
                        updateCharts,
                        clearComparison,
                        getDatasetTags,
                        getTagIcon,
                        getTagDisplayName,
                        getDisplayName,
                        getDatasetByName,
                        cardCollapsed,
                        toggleCardCollapse,
                        mainCardCollapsed,
                        toggleMainCardCollapse,
                        getCardStyle,
                        getCardHeaderStyle,
                        chartColorBase,
                        showOriginalCard, // 新增暴露
                        triggerCheckboxClick, // 新增暴露
                        searchInput,
                        searchQuery,
                        applySearch,
                        filteredDatasets,
                        clearSearch, // 新增暴露
                        selectedHeuristicDatasets,
                        expandedCards, // 新增暴露
                        toggleCard, // 新增暴露
                        getModelBasedQLineChartData, // 新增暴露
                    };
                },
            });
            function openFeedbackForm() {
                const googleFormUrl =
                    "https://docs.google.com/forms/d/e/1FAIpQLSe2Mh4L3e-1TvlCl-Qfl_WasFk2dPO2mFcbmfMG4iF9IgKuIQ/viewform?usp=dialog";
                try {
                    const newWindow = window.open(
                        googleFormUrl,
                        "_blank",
                        "width=800,height=600,scrollbars=yes,resizable=yes"
                    );
                    if (
                        !newWindow ||
                        newWindow.closed ||
                        typeof newWindow.closed === "undefined"
                    ) {
                        window.location.href = googleFormUrl;
                    }
                } catch (error) {
                    window.location.href = googleFormUrl;
                }
            }
            app.mount("#app");
        </script>
        <footer>
            <div class="footer-content">
                <div class="footer-links">
                    <h4>Related Links</h4>
                    <div class="links-container">
                        <a
                            href="https://opendalab.github.io"
                            target="_blank"
                            rel="noopener noreferrer"
                        >
                            <i class="fas fa-globe"></i>
                            OpenDataLab Research
                        </a>
                        <a
                            href="https://opendatalab.org.cn"
                            target="_blank"
                            rel="noopener noreferrer"
                        >
                            <i class="fas fa-home"></i>
                            OpenDataLab
                        </a>
                        <a
                            href="#"
                            class="github-repo-link"
                            target="_blank"
                            rel="noopener noreferrer"
                        >
                            <i class="fab fa-github"></i>
                            GitHub Repository
                        </a>
                        <a
                            href="mailto:opendataarena@163.com"
                            class="contact-link"
                        >
                            <i class="fas fa-envelope"></i>
                            Contact Us
                        </a>
                    </div>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 OpenDataArena. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </body>
</html>
